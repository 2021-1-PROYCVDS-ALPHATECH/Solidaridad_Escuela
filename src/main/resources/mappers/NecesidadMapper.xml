<?xml version="1.0" encoding="UTF-8"?> 

<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="edu.eci.cvds.sampleprj.dao.mybatis.mappers.NecesidadMapper">
    <select parameterType="map" id="consultarNecesidades" resultMap="NecesidadResult">
        SELECT 
            n.idNecesidad AS n_idNecesidad,
            n.idUsuario AS n_idUsuario, 
            n.nombre AS n_nombre,
            n.descripcion AS n_descripcion,
            n.urgencia AS n_urgencia,
            n.fechaCreacion AS n_fechaCreacion,
            n.fechaModificacion AS n_fechaModificacion,
            n.estado AS n_estado,
            c.idCategoria AS c_categoria,
            c.nombre AS c_nombre,
            c.descripcion AS c_descripcion,
            c.fechaCreacion AS c_fechaCreacion,
            c.fechaModificacion AS c_fechaModificacion,
            c.estado AS c_estado
        FROM necesidades n 
        LEFT JOIN categorias c ON c.idcategoria = n.categoria 
    </select>

    <resultMap id="NecesidadResult" type="Necesidad">
        <id property='idNecesidad' column='n_idNecesidad' />
        <id property="idUsuario" column="n_idUsuario" />
        <result property="nombre" column="n_nombre"/>
        <result property="descripcion" column="n_descripcion"/>
        <result property="urgencia" column="n_urgencia"/>
        <result property="fechaCreacion" column="n_fechaCreacion"/>
        <result property="fechaModificacion" column="n_fechaModificacion"/>
        <result property="estado" column="n_estado"/>
        <association property="categoria" resultMap="CategoriaResult"></association>
    </resultMap>

    <resultMap type='Categoria' id='CategoriaResult'>
        <id property='idCategoria' column='c_idCategoria'/>
        <result property='nombre' column='c_nombre'/>
        <result property='descripcion' column='c_descripcion'/>  
        <result property='fechaCreacion' column='c_fechaCreacion'/>  
        <result property='fechaModificacion' column='c_fechaModificacion'/>  
        <result property='estado' column='c_estado'/>  
    </resultMap>

</mapper>